(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["export-excel"],{1:function(e,t){},2:function(e,t){},"2bf8":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n("99af"),n("4160"),n("d81d"),n("c19f"),n("ace4"),n("d3b7"),n("25f0"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("159b");var a=n("2909"),r=n("d4ec"),i=n("21a6"),o=n("1146"),l=n.n(o),s=function e(){Object(r["a"])(this,e),this.SheetNames=[],this.Sheets={}},c=function(e){return(+e-+new Date(Date.UTC(1899,11,30)))/864e5},u=function(e){for(var t={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},a=0;a!==e.length;++a)for(var r=0;r!==e[a].length;++r){n.s.r>a&&(n.s.r=a),n.s.c>r&&(n.s.c=r),n.e.r<a&&(n.e.r=a),n.e.c<r&&(n.e.c=r);var i={v:e[a][r],t:"",z:""};if(null!=i.v){var o=l.a.utils.encode_cell({c:r,r:a});"number"===typeof i.v?i.t="n":"boolean"===typeof i.v?i.t="b":i.v instanceof Date?(i.t="n",i.z=l.a.SSF.get_table()[14],i.v=c(i.v)):i.t="s",t[o]=i}}return n.s.c<1e7&&(t["!ref"]=l.a.utils.encode_range(n)),t},d=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),a=0;a!==e.length;++a)n[a]=255&e.charCodeAt(a);return t},p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"excel-list",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"xlsx";t=Object(a["a"])(t),t.unshift(e);for(var f=r.length-1;f>-1;f--)t.unshift(r[f]);var h="SheetJS",m=new s,b=u(t);if(o.length>0&&(b["!merges"]||(b["!merges"]=[]),o.forEach((function(e){b["!merges"].push(l.a.utils.decode_range(e))}))),c){for(var v=t.map((function(e){return e.map((function(e){return null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}}))})),g=v[0],w=1;w<v.length;w++)for(var y=0;y<v[w].length;y++)g[y]["wch"]<v[w][y]["wch"]&&(g[y]["wch"]=v[w][y]["wch"]);b["!cols"]=g}m.SheetNames.push(h),m.Sheets[h]=b;var k=l.a.write(m,{bookType:p,bookSST:!1,type:"binary"});Object(i["saveAs"])(new Blob([d(k)],{type:"application/octet-stream"}),"".concat(n,".").concat(p))}},3:function(e,t){},4468:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticStyle:{"text-align":"right","margin-bottom":"20px"}},[n("el-button",{attrs:{type:"primary"},on:{click:e.editorUser}},[e._v(" 新增用户 ")])],1),n("el-table",{attrs:{data:e.list,border:""}},[n("el-table-column",{attrs:{width:"95",align:"center",label:"Id",prop:"user_id"}}),n("el-table-column",{attrs:{width:"95",align:"center",label:"账号",prop:"user_name"}}),n("el-table-column",{attrs:{width:"95",align:"center",label:"手机号",prop:"user_phone"}}),n("el-table-column",{attrs:{width:"220",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.editorUser(t.row)}}},[e._v(" 编辑 ")]),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return e.deleteUser(t.row.user_id)}}},[e._v(" 删除 ")])]}}])})],1),n("el-dialog",{attrs:{title:e.dialongTitle,visible:e.dialogVisible,"close-on-click-modal":!1,width:"40%","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"账号",prop:"userName"}},[n("el-input",{model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}})],1),n("el-form-item",{attrs:{label:"密码",type:"password",prop:"password",autocomplete:"off"}},[n("el-input",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),n("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[n("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 取 消 ")]),n("el-button",{attrs:{type:"primary"},on:{click:e.submitFrom}},[e._v(" 确 定 ")])],1)],1)],1)},r=[],i=(n("96cf"),n("1da1")),o=n("d4ec"),l=n("bee2"),s=n("2caf"),c=n("262e"),u=n("9ab4"),d=n("60a3"),p=n("b8f0"),f=function(e){Object(c["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.list=[],e.dialongTitle="新增",e.dialogVisible=!1,e.rules={userName:[{required:!0,message:"请输入账号",trigger:"blur"},{min:3,max:15,message:"长度在 3 到 15 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入账号密码",trigger:"blur"},{min:5,max:16,message:"长度在 5 到 16 个字符",trigger:"blur"}]},e.ruleForm={userName:"",password:"",phone:""},e}return Object(l["a"])(n,[{key:"created",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["f"])();case 2:t=e.sent,n=t.data,this.list=n;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"editorUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.user_id?(this.dialongTitle="编辑",this.ruleForm={userName:t.user_name,password:t.user_password,phone:t.user_phone,user_id:t.user_id}):this.dialongTitle="新增",this.dialogVisible=!0;case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteUser",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(p["h"])({id:t});case 2:e.sent,n.fetchData(),n.$message({type:"success",message:"删除成功!"});case 5:case"end":return e.stop()}}),e)})))).catch((function(){n.$message({type:"info",message:"已取消删除"})}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleClose",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs.ruleForm.resetFields(),this.ruleForm={userName:"",password:"",phone:""};case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"submitFrom",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("新增"!==this.dialongTitle){e.next=6;break}return e.next=3,Object(p["g"])({user_name:this.ruleForm.userName,user_password:this.ruleForm.password,user_phone:this.ruleForm.phone});case 3:e.sent,e.next=9;break;case 6:return e.next=8,Object(p["i"])({user_name:this.ruleForm.userName,user_password:this.ruleForm.password,user_phone:this.ruleForm.phone,user_id:this.ruleForm.user_id});case 8:e.sent;case 9:this.handleClose(),this.dialogVisible=!1,this.fetchData(),this.$message({message:"提交成功！",type:"success"});case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(d["c"]);f=Object(u["a"])([Object(d["a"])({name:"ExportExcel",components:{}})],f);var h=f,m=h,b=n("2877"),v=Object(b["a"])(m,a,r,!1,null,null,null);t["default"]=v.exports},"5fb3":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",[n("filename-option",{model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),n("auto-width-option",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}}),n("book-type-option",{model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}}),n("el-button",{staticStyle:{margin:"0 0 20px 20px"},attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v(" "+e._s(e.$t("excel.export"))+" Excel ")]),n("a",{staticStyle:{"margin-left":"15px"},attrs:{href:"https://armour.github.io/vue-typescript-admin-docs/features/components/excel.html",target:"_blank"}},[n("el-tag",{attrs:{type:"info"}},[e._v("Documentation")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading...",border:"",fit:"","highlight-current-row":""}},[n("el-table-column",{attrs:{width:"95",align:"center",label:"Id"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.$index)+" ")]}}])}),n("el-table-column",{attrs:{label:"Title"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title)+" ")]}}])}),n("el-table-column",{attrs:{label:"Author",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",[e._v(e._s(t.row.author))])]}}])}),n("el-table-column",{attrs:{width:"115",align:"center",label:"Readings"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pageviews)+" ")]}}])}),n("el-table-column",{attrs:{width:"220",align:"center",label:"Date"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon-time"}),n("span",[e._v(e._s(e._f("parseTime")(t.row.timestamp)))])]}}])}),n("el-table-column",{attrs:{width:"220",align:"center",label:"Image"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("img",{attrs:{src:e.row.imageurl,width:"50",alt:""}})]}}])})],1)],1)},r=[],i=(n("96cf"),n("1da1")),o=n("d4ec"),l=n("bee2"),s=n("2caf"),c=n("262e"),u=n("9ab4"),d=n("60a3"),p=n("d257"),f=n("2bf8"),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"inline-block"}},[n("label",{staticClass:"radio-label",staticStyle:{"padding-left":"0"}},[e._v("Filename: ")]),n("el-input",{staticStyle:{width:"345px"},attrs:{placeholder:e.$t("excel.placeholder"),"prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}})],1)},m=[],b=function(e){Object(c["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(l["a"])(n,[{key:"filename",get:function(){return this.value},set:function(e){this.$emit("input",e)}}]),n}(d["c"]);Object(u["a"])([Object(d["b"])({required:!0})],b.prototype,"value",void 0),b=Object(u["a"])([Object(d["a"])({name:"FilenameOption"})],b);var v=b,g=v,w=n("2877"),y=Object(w["a"])(g,h,m,!1,null,null,null),k=y.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"inline-block"}},[n("label",{staticClass:"radio-label"},[e._v("Cell Auto-Width: ")]),n("el-radio-group",{model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}},[n("el-radio",{attrs:{label:!0,border:""}},[e._v(" True ")]),n("el-radio",{attrs:{label:!1,border:""}},[e._v(" False ")])],1)],1)},_=[],O=function(e){Object(c["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(l["a"])(n,[{key:"autoWidth",get:function(){return this.value},set:function(e){this.$emit("input",e)}}]),n}(d["c"]);Object(u["a"])([Object(d["b"])({required:!0})],O.prototype,"value",void 0),O=Object(u["a"])([Object(d["a"])({name:"AutoWidthOption"})],O);var j=O,F=j,S=Object(w["a"])(F,x,_,!1,null,null,null),T=S.exports,$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{display:"inline-block"}},[n("label",{staticClass:"radio-label"},[e._v("Book Type: ")]),n("el-select",{staticStyle:{width:"120px"},model:{value:e.bookType,callback:function(t){e.bookType=t},expression:"bookType"}},e._l(e.options,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)},R=[],C=function(e){Object(c["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.options=["xlsx","csv","txt"],e}return Object(l["a"])(n,[{key:"bookType",get:function(){return this.value},set:function(e){this.$emit("input",e)}}]),n}(d["c"]);Object(u["a"])([Object(d["b"])({required:!0})],C.prototype,"value",void 0),C=Object(u["a"])([Object(d["a"])({name:"BookTypeOption"})],C);var D=C,N=D,W=Object(w["a"])(N,$,R,!1,null,null,null),A=W.exports,E=function(e){Object(c["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.list=[],e.listLoading=!0,e.downloadLoading=!1,e.filename="",e.autoWidth=!0,e.bookType="xlsx",e}return Object(l["a"])(n,[{key:"created",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.listLoading=!0,setTimeout((function(){t.listLoading=!1}),500);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"handleDownload",value:function(){this.downloadLoading=!0;var e=["Id","Title","Author","Readings","Date","Image"],t=["id","title","author","pageviews","timestamp","imageurl"],n=this.list,a=Object(p["b"])(t,n);Object(f["a"])(e,a,""!==this.filename?this.filename:void 0,void 0,void 0,this.autoWidth,this.bookType),this.downloadLoading=!1}}]),n}(d["c"]);E=Object(u["a"])([Object(d["a"])({name:"ExportExcel",components:{AutoWidthOption:T,BookTypeOption:A,FilenameOption:k}})],E);var L=E,B=L,U=(n("b8d9"),Object(w["a"])(B,a,r,!1,null,null,null));t["default"]=U.exports},b8d9:function(e,t,n){"use strict";var a=n("ba90"),r=n.n(a);r.a},ba90:function(e,t,n){e.exports={menuBg:"#304156",menuText:"#bfcbd9",menuActiveText:"#409eff"}}}]);